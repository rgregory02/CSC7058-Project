<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add a New Type</title>
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; background:#f2f4f8; padding:40px; }
    .box { background:#fff; max-width:720px; margin:auto; padding:28px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.08); }
    h1 { margin:0 0 6px; }
    .subtext { color:#556; margin-bottom:18px; }
    .row { margin:12px 0; }
    .label { display:block; font-weight:700; margin-bottom:6px; }
    input[type="text"], select {
      width:100%; padding:10px; border:1px solid #cfd6e4; border-radius:8px; font-size:1rem; background:#fff;
    }
    .muted { color:#667085; font-size:.9em; }
    .inline { display:flex; gap:12px; align-items:center; }
    .btn { padding:10px 16px; border-radius:10px; border:none; font-weight:700; cursor:pointer; }
    .btn.primary { background:#6c63ff; color:#fff; }
    .btn.secondary { background:#eef0f7; color:#333; text-decoration:none; }
    .actions { display:flex; gap:10px; margin-top:16px; }
    .flash { padding:10px; border-radius:10px; margin:10px 0; font-weight:700; }
    .flash-success { background:#eaffea; color:#2e7d32; border:1px solid #a5d6a7; }
    .flash-error { background:#ffeaea; color:#c62828; border:1px solid #ef9a9a; }
    .pill { display:inline-block; padding:4px 8px; border-radius:999px; background:#f2f4f8; font-size:.85em; margin-left:6px; }
    .hint { font-size:.9em; color:#667085; margin-top:6px; }
  </style>
</head>
<body>
  <div class="box">
    <h1>➕ Add a New Type</h1>
    <div class="subtext">Create a category (e.g., <em>vehicle</em>, <em>award</em>, <em>affiliation</em>) for biographies and labels.</div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="flash flash-{{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('add_type_prompt') }}">
      <div class="row">
        <label class="label" for="new_type_name">Type name</label>
        <input type="text" id="new_type_name" name="new_type_name" placeholder="e.g. award" required oninput="updateSlug()">
        <div class="hint">Slug: <span id="slug_preview" class="pill">—</span></div>
      </div>

      <div class="row">
        <label class="label" for="base_type">Base on existing (optional)</label>
        <select id="base_type" name="base_type">
          <option value="">— None —</option>
          {% for t in existing_types %}
            <option value="{{ t }}">{{ t }}</option>
          {% endfor %}
        </select>
        <div class="hint">If selected, we’ll copy <code>labels/</code> as a starting point.</div>
      </div>

      <div class="row">
        <label class="label">Scaffold</label>
        <div class="inline">
          <label class="inline"><input type="checkbox" name="mk_labels" checked> <span>labels/</span></label>
          <label class="inline"><input type="checkbox" name="mk_biographies" checked> <span>biographies/</span></label>
        </div>
        <div class="hint">We’ll also create a minimal <code>type_info.json</code>.</div>
      </div>
<div class="actions">
  <button type="submit" class="btn primary">✅ Create Type</button>
  <button type="button" onclick="window.location.href='{{ url_for('dashboard') }}'" class="btn secondary">⏭️ Return to Dashboard</button>
</div>
    </form>
  </div>

  <script>
    function slugify(s){
      return (s||"").toLowerCase().replace(/[^a-z0-9_]+/g,"_").replace(/^_+|_+$/g,"");
    }
    function updateSlug(){
      const v = document.getElementById('new_type_name').value;
      document.getElementById('slug_preview').textContent = slugify(v) || "—";
    }
    document.addEventListener('DOMContentLoaded', updateSlug);
  </script>
</body>
</html>
