<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Biography Studio – Dashboard</title>
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    body { background:#f6f7fb; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
    .box { max-width: 1100px; margin: 40px auto; background:#fff; padding:28px; border-radius:14px; box-shadow:0 8px 24px rgba(0,0,0,.06); }
    .toolbar { display:flex; flex-wrap:wrap; gap:10px; margin:16px 0 22px; }
    .btn{display:inline-block;padding:10px 16px;border-radius:10px;background:#6c63ff;color:#fff;text-decoration:none;font-weight:600}
    .btn.secondary{background:#eef0f7;color:#333}
    .btn.ghost{background:transparent;color:#6c63ff;border:1px solid #6c63ff}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
    .card{background:#fff;border:1px solid #e7e9f2;border-radius:12px;padding:16px}
    .card h3{margin:0 0 6px}
    .card .muted{color:#657085;font-size:12px}
    .quick{display:flex;flex-wrap:wrap;gap:6px;margin:10px 0 6px}
    ul.slim{margin:6px 0 0 18px;text-align:left}
    small{color:#657085}
    .header { display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .header h1 { margin:0 }
  </style>
</head>
<body>
  <div class="box">
    <div class="header">
      <h1>📚 Biography Studio</h1>
      <div class="toolbar">
        <!-- General, type-agnostic creation flow -->
        <a class="btn" href="{{ url_for('general_iframe_wizard', step='start') }}">
  🧩 Start Biography Wizard
</a>

        <!-- Optional: quick link to people browse page (your old index view) -->
      </div>
      <div class="toolbar">
        <!-- Optional: create a new Type right from here -->
        <a class="btn secondary" href="{{ url_for('add_type_prompt') }}">➕ Add New Type</a>

        <!-- NEW: archived types hub -->
        <a class="btn secondary" href="{{ url_for('archived_types_list') }}">📦 Archived Types</a>
      </div>
    </div>

    <h2 style="margin:10px 0 14px">Types</h2>

    <div class="grid">
      {% for t in types %}
        <div class="card">
          <h3>{{ t|replace('_',' ')|title }}</h3>
          <div class="muted">Manage {{ t|replace('_',' ') }} biographies & labels</div>

          <div class="quick">
            <!-- Browse all bios for this type -->
            <a class="btn secondary" href="{{ url_for('type_browse', type_name=t) }}">📂 Browse Biographies</a>

            <!-- Create a new biography for this type -->
<!-- Create a new biography for this type -->
<a class="btn"
   href="{{ url_for('general_iframe_wizard', step='start', type=t, return_url=url_for('type_browse', type_name=t)) }}">
  ➕ New {{ t|replace('_',' ')|title }} Biography
</a>


            <a class="btn secondary" href="{{ url_for('type_properties', type_name=t) }}">⚙️ Manage Properties</a>

<a class="btn secondary" href="{{ url_for('type_labels', type_name=t) }}">🏷️ Manage Labels</a>


            <!-- NEW: archive this type -->
            <a class="btn ghost"
               href="{{ url_for('archive_type_confirm', type_name=t) }}"
               onclick="return confirm('Archive this entire type (labels & biographies) to /archive/types ? You can restore later.');">
              🗃️ Archive Type
            </a>
          </div>

          {% if preview[t] %}
            <div><small>Recent:</small></div>
            <ul class="slim">
              {# preview[t] may be objects with .id/.name or tuples (id, name) #}
              {% for b in preview[t] %}
                {% set bid = (b.id if b is mapping or (b is defined and b.id is defined) else (b[0] if b is sequence else b)) %}
                {% set bname = (b.name if b is mapping or (b is defined and b.name is defined) else (b[1] if b is sequence and b|length>1 else bid)) %}
                <li>
                  <a href="{{ url_for('general_iframe_wizard', type=t, bio_id=bid, step='labels') }}">{{ bname }}</a>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <small>No biographies yet.</small>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</body>
</html>


