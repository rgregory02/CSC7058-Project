<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Select Time ‚Äì {{ name }}</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
  <div class="box">
    <h1>‚è≥ Select Time Period</h1>
    <div class="subheading">
      <strong>Name:</strong> {{ name }}<br>
      <strong>Type:</strong> {{ type_name|replace('_', ' ')|title }}
    </div>

    <form method="POST" action="{{ url_for('time_step', type_name=type_name, bio_id=bio_id) }}">
      <label for="label_type">Time Type:</label>
      <select name="label_type" id="label_type" onchange="this.form.submit()">
        <option value="">-- Choose --</option>
        {% for label, desc in label_files %}
          <option value="{{ label }}" {% if label == selected_label_type %}selected{% endif %}>
            {{ label.replace('_', ' ')|title }} ‚Äì {{ desc }}
          </option>
        {% endfor %}
      </select>
      <br><br>

      {% if selected_label_type == "date" %}
        <label for="date_value">üìÖ Select Date:</label>
        <input type="date" name="date_value" id="date_value" value="{{ selected_date }}"><br><br>
      {% elif selected_label_type %}
        <label for="subvalue">üè∑Ô∏è Choose {{ selected_label_type.replace('_', ' ')|title }}:</label>
        <select name="subvalue" id="subvalue">
          <option value="">-- Choose --</option>
          {% for sub in subfolder_labels %}
            <option value="{{ sub.name }}" {% if sub.name == selected_subvalue %}selected{% endif %}>
              {{ sub.name.replace('_', ' ')|title }} ‚Äì {{ sub.description }}
            </option>
          {% endfor %}
        </select><br><br>
      {% endif %}

      {% if selected_label_type %}
        <label for="confidence">üîç Confidence:</label><br>
        <input type="range" id="confidence" name="confidence" min="0" max="100"
               value="{{ selected_confidence or 100 }}" oninput="updateConfidenceDisplay(this.value)">
        <span id="confidence_display">{{ selected_confidence or 100 }}%</span>
        <br><br>
      {% endif %}

      <div style="margin-top: 20px;">
        {% if edit_entry_index is not none %}
          <button type="submit">üíæ Save Edits</button>
          <button type="submit" name="cancel_edit" value="true">‚ùå Cancel</button>
        {% else %}
          <button type="submit">‚û°Ô∏è Continue</button>
        {% endif %}
      </div>
    </form>

    {% if existing_entries %}
      <hr>
      <h3>üóÇÔ∏è Existing Entries</h3>
      <ul>
        {% for label, confidence in existing_entries %}
          <li>{{ label }} ({{ confidence }}%)</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>

  <script>
    function updateConfidenceDisplay(value) {
      document.getElementById("confidence_display").textContent = value + "%";
    }
  </script>
</body>
</html>
